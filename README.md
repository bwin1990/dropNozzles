# 喷嘴数据分析工具 (Drop Nozzles Analysis Tool)

## 程序目的

该工具用于分析打印机喷嘴数据，主要针对680K和340K两种容量规格，实现以下功能：

1. 读取CSV格式的喷嘴位置数据
2. 计算喷嘴编号，包括正常范围内的编号和超出范围的位置
3. 生成包含所有计算结果的输出文件，包括"out of range"标记
4. 提供详细的调试信息，帮助分析喷嘴位置问题

## 数据处理流程

1. **数据输入**
   - 通过文件对话框选择CSV格式的数据文件
   - 从文件名中提取容量信息（340K或680K）
   - 手动解析CSV文件，确保所有数据点（包括第一行）都被正确处理

2. **数据分组**
   - 按标签（A.tif, T.tif, C.tif, G.tif, ACT.tif）对数据进行分组
   - 为每个标签创建单独的DataFrame，包含Index、X和Y坐标

3. **数据旋转**
   - 使用`rotate_to_vertical`函数将数据旋转至垂直方向
   - 确保喷嘴位置计算的准确性

4. **喷嘴位置计算**
   - 340K容量：使用`find_nozzle_340k`函数计算喷嘴编号
   - 680K容量：使用`find_nozzle_680k`函数计算喷嘴编号
   - 对于超出正常范围的位置，标记为"out of range"

5. **结果输出**
   - 生成包含所有计算结果的文本文件，包括数字编号和"out of range"标记
   - 文件名格式：`flaw_nozzle_YYYYMMDD_容量_机器编号.txt`
   - 输出格式为逗号分隔的值列表

## 使用方法

1. 运行`process_drops.py`
2. 在弹出的文件对话框中选择CSV数据文件
3. 输入机器编号（可选）
4. 程序自动处理数据并显示结果
5. 确认后，结果将保存到输出文件

## 关键函数

- `process_drops_data`: 读取和解析CSV数据
- `rotate_to_vertical`: 旋转数据点至垂直方向
- `find_nozzle_340k`: 计算340K容量的喷嘴编号
- `find_nozzle_680k`: 计算680K容量的喷嘴编号
- `auto_cal_flaw_340k`: 自动计算340K喷嘴缺陷
- `auto_cal_flaw_680k`: 自动计算680K喷嘴缺陷

## 注意事项

- 所有计算结果都会保留在输出中，包括"out of range"标记
- 程序会显示详细的调试信息，帮助分析喷嘴位置问题
- 当检测到"out of range"位置时，会显示警告信息
